---
title: Demo of Static Analysis Using Strings
tags:
 - malware
 - lecture
 - yara
 - strings
 - static analysis
---
## {{page.title}}

This lecture primarily focused on building yara signatures for detection through static
analysis, and also documenting interesting findings from your analysis. In particular,
we focused on cataloging the sample, creating an initial malware report template, and
performing analysis of the **strings** data from the file.

**Unfortunately, lecture video needs to be re-recorded for this topic**

We analyzed the following malware sample:

```
1bc9ab02d06ee26a82b5bd910cf63c07b52dc83c4ab9840f83c1e8be384b9254  VirusShare_f7f85d7f628ce62d1d8f7b39d8940472
```

Our findings were documented in the following malware report

* [ex1.ltx (LaTeX Source)](/code/ex1.ltx)
* [ex1.pdf (PDF final)](/code/ex1.pdf)

After some work, we created the following yara rule (signature) to identify it:

```perl
rule ex1_rule {
 meta:
  author = "Coleman Kane"

 strings:
  /* Malicious strings */
  $mal_seturl2 = "seturl2"
  $mal_seturl1 = "seturl1"
  $mal_setsleep = "setsleep"
  $mal_makefile = "makefile"
  $mal_mkcmdshell = "mkcmdshell"
  $mal_mkcmdload = "mkcmdload"
  $mal_mkcmdrun = "mkcmdrun"
  $mal_mkcmddown = "mkcmddown"
  $mal_mkcmddownrun = "mkcmddownrun"
  $mal_mkcmdsleep = "mkcmdsleep"

  /* Strings identifying legit programs. */
  $legit_mcafee = "McAfee Anti-Virus"

 condition:
  4 of ($mal_*) and 0 of ($legit_*)

}
```

Our yara rule identified two more "similar" samples in our library:

```
13e40ee7c6874e2f1ed58bc09738a5525f86361f1a85387b2110f114d8f3272a  VirusShare_0149b7bd7218aab4e257d28469fddb0d
f79e4adc2cd11f9e44023cbdb827777a0c44af44bb19b494bef2d2d8e6e3be02  VirusShare_1415eb8519d13328091cc5c76a624e3d
```


I provided a very simple malware analysis LaTeX template here, that could be used for
future work:

* [mw_report.ltx](/code/mw_report.ltx)

My current approach has been to use the following steps to create a new report from the
above template and generate a PDF from it:

```bash
cp mw_report.ltx sample1_exe.ltx
vim sample1_exe.ltx # Open new report in editor, and make changes
```

Once you've filled in your report details, then you could use latex to author it into
a PDF document named <code>sample1_exe.pdf</code>:
```bash
latex sample1_exe.ltx
latex sample1_exe.ltx
dvipdf sample1_exe.dvi
```

[home](/)
