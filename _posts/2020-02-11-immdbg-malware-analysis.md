---
title: Immunity Debugger Intro, Capture &amp; Reroute Malware Traffic
author: Coleman Kane
tags:
 - malware
 - ghidra
 - immunity debugger
 - disassembly
 - lecture
---

This lecture introduces some basic Immunity Debugger usage and walks through a number
of configurations that enable the malware to execute in the VM, still attempt to communicate
to its home IP, but get routed to a `nc` listener I set up so we can capture the traffic
and interact with the backdoor.

<iframe width="560" height="315" src="https://www.youtube.com/embed/DBGULfyQCZQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

# IPTABLES command

On the VM I wanted to capture the traffic from, I ran a command using `iptables` to route
the traffic to a local port. Here is that command:
```bash
iptables -t nat -I PREROUTING --src 0/0 --dst 192.168.12.71 -p tcp --dport 444 -j REDIRECT --to-ports 8444
```

[home](/)
